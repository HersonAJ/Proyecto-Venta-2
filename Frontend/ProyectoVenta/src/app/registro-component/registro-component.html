<section class="register-section bg-dark text-white min-vh-100 d-flex align-items-center py-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-8 col-lg-6">
        
        <!-- Card de Registro -->
        <div class="register-card bg-dark border border-warning rounded-4 p-4 shadow-lg">
          
          <!-- Logo y t√≠tulo -->
          <div class="text-center mb-4">
            <div class="logo-placeholder bg-warning text-dark rounded p-3 d-inline-block mb-3">
              <h4 class="mb-0 fw-bold">üå≠ HOT DOGS & TORTAS</h4>
            </div>
            
            <!-- T√≠tulo din√°mico -->
            @if (!registroExitoso) {
              <h2 class="fw-bold text-warning">Crear Cuenta</h2>
              <p class="opacity-90">√önete a nuestra comunidad</p>
            }
          </div>

          <!-- Mensaje de error -->
          @if (errorMessage) {
            <div class="error-message-custom bg-dark border border-danger rounded p-3 mb-3">
              <div class="d-flex align-items-center">
                <span class="text-danger me-2">‚ö†Ô∏è</span>
                <span class="text-light">{{ errorMessage }}</span>
              </div>
            </div>
          }

          <!-- Mensaje de √©xito -->
          @if (registroExitoso) {
            <div class="success-message-custom bg-dark border border-success rounded-4 p-4 text-center">
              <div class="mb-3">
                <span class="text-success fs-1">‚úÖ</span>
              </div>
              <h3 class="text-success fw-bold mb-3">¬°Registro Exitoso!</h3>
              <p class="text-light mb-4">{{ mensajeExito }}</p>
              
              <div class="d-grid gap-2">
                <button 
                  class="btn btn-success py-2 fw-bold"
                  (click)="irAInicio()"
                >
                  üöÄ Ir a Inicio
                </button>
                <button 
                  class="btn btn-outline-warning py-2"
                  (click)="volverARegistro()"
                >
                  üìù Crear otra cuenta
                </button>
              </div>
            </div>
          }

          <!-- Formulario de registro (solo mostrar si no hay √©xito) -->
          @if (!registroExitoso) {
            <form (ngSubmit)="onRegister()" #registerForm="ngForm">
              <div class="row">
                <!-- Nombre Completo -->
                <div class="col-md-6 mb-3">
                  <label for="nombre" class="form-label text-warning fw-bold">üë§ Nombre Completo</label>
                  <input 
                    type="text" 
                    class="form-control bg-dark text-white border-warning" 
                    id="nombre"
                    name="nombre"
                    [(ngModel)]="registerData.nombre"
                    placeholder="Tu nombre completo"
                    required
                    minlength="3"
                    #nombre="ngModel"
                    [class.is-invalid]="nombre.invalid && nombre.touched"
                  >
                  @if (nombre.invalid && nombre.touched) {
                    <div class="invalid-feedback">
                      @if (nombre.errors?.['required']) {
                        <div>El nombre es requerido</div>
                      }
                      @if (nombre.errors?.['minlength']) {
                        <div>M√≠nimo 3 caracteres</div>
                      }
                    </div>
                  }
                </div>

                <!-- Tel√©fono -->
                <div class="col-md-6 mb-3">
                  <label for="telefono" class="form-label text-warning fw-bold">üìû Tel√©fono</label>
                  <input 
                    type="tel" 
                    class="form-control bg-dark text-white border-warning" 
                    id="telefono"
                    name="telefono"
                    [(ngModel)]="registerData.telefono"
                    placeholder="12345678"
                    pattern="[0-9]{8}"
                    #telefono="ngModel"
                    [class.is-invalid]="telefono.invalid && telefono.touched"
                  >
                  @if (telefono.invalid && telefono.touched) {
                    <div class="invalid-feedback">
                      Ingresa un n√∫mero de 8 d√≠gitos
                    </div>
                  }
                </div>
              </div>

              <!-- Email -->
              <div class="mb-3">
                <label for="email" class="form-label text-warning fw-bold">üìß Correo Electr√≥nico</label>
                <input 
                  type="email" 
                  class="form-control bg-dark text-white border-warning" 
                  id="email"
                  name="email"
                  [(ngModel)]="registerData.email"
                  placeholder="tu@email.com"
                  required
                  #email="ngModel"
                  [class.is-invalid]="email.invalid && email.touched"
                >
                @if (email.invalid && email.touched) {
                  <div class="invalid-feedback">
                    Por favor ingresa un correo v√°lido
                  </div>
                }
              </div>

              <!-- Contrase√±a -->
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="password" class="form-label text-warning fw-bold">üîí Contrase√±a</label>
                  <input 
                    type="password" 
                    class="form-control bg-dark text-white border-warning" 
                    id="password"
                    name="password"
                    [(ngModel)]="registerData.password"
                    placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                    required
                    minlength="6"
                    #password="ngModel"
                    [class.is-invalid]="password.invalid && password.touched"
                  >
                  @if (password.invalid && password.touched) {
                    <div class="invalid-feedback">
                      @if (password.errors?.['required']) {
                        <div>La contrase√±a es requerida</div>
                      }
                      @if (password.errors?.['minlength']) {
                        <div>M√≠nimo 6 caracteres</div>
                      }
                    </div>
                  }
                </div>

                <!-- Confirmar Contrase√±a -->
                <div class="col-md-6 mb-3">
                  <label for="confirmPassword" class="form-label text-warning fw-bold">üîí Confirmar Contrase√±a</label>
                  <input 
                    type="password" 
                    class="form-control bg-dark text-white border-warning" 
                    id="confirmPassword"
                    name="confirmPassword"
                    [(ngModel)]="confirmPassword"
                    placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"
                    required
                    #confirmPasswordInput="ngModel"
                    [class.is-invalid]="(confirmPasswordInput.invalid && confirmPasswordInput.touched) || passwordMismatch"
                    (input)="onInputChange()"
                  >
                  @if ((confirmPasswordInput.invalid && confirmPasswordInput.touched) || passwordMismatch) {
                    <div class="invalid-feedback">
                      @if (confirmPasswordInput.errors?.['required']) {
                        <div>Confirma tu contrase√±a</div>
                      }
                      @if (passwordMismatch) {
                        <div>Las contrase√±as no coinciden</div>
                      }
                    </div>
                  }
                </div>
              </div>

<!-- Avatar Selection - FLEXBOX RESPONSIVE -->
<div class="mb-4">
  <label class="form-label text-warning fw-bold mb-3">üé≠ Elige tu Avatar</label>
  <div class="avatar-selection">
    <!-- Flexbox con wrap para mejor responsividad -->
    <div class="d-flex flex-wrap justify-content-center gap-3">
      @for (avatar of availableAvatars; track avatar.id) {
        <div 
          class="avatar-option position-relative rounded-circle cursor-pointer"
          [class.avatar-selected]="registerData.avatarId === avatar.id"
          (click)="selectAvatar(avatar.id)"
          style="
            width: 75px; 
            height: 75px;
            border: 3px solid transparent;
            transition: all 0.2s ease;
          "
          [style.border-color]="registerData.avatarId === avatar.id ? '#ffc107' : '#6c757d'"
          [style.transform]="registerData.avatarId === avatar.id ? 'scale(1.1)' : 'scale(1)'"
        >
          <img 
            [src]="avatar.imageUrl" 
            [alt]="'Avatar ' + avatar.id"
            class="rounded-circle w-100 h-100"
            style="object-fit: cover;"
          >
          <!-- Indicador visual de selecci√≥n -->
          @if (registerData.avatarId === avatar.id) {
            <div class="position-absolute top-0 end-0 bg-warning rounded-circle" 
                 style="width: 20px; height: 20px; display: flex; align-items: center; justify-content: center;">
              <span class="text-dark fw-bold" style="font-size: 12px;">‚úì</span>
            </div>
          }
        </div>
      }
    </div>
    
    <!-- Indicador de selecci√≥n -->
    <div class="text-center mt-3">
      <div class="badge bg-warning bg-opacity-25 text-warning px-3 py-2 border border-warning">
        <span class="fw-bold">Avatar #{{ registerData.avatarId }}</span>
      </div>
    </div>
  </div>
</div>
              <!-- T√©rminos y condiciones -->
              <div class="mb-4 form-check">
                <input 
                  type="checkbox" 
                  class="form-check-input" 
                  id="terminos"
                  [(ngModel)]="registerData.aceptaTerminos"
                  name="terminos"
                  required
                  #terminos="ngModel"
                >
                <label class="form-check-label opacity-90" for="terminos">
                  Acepto los <a href="#" class="text-warning">T√©rminos de Servicio</a> 
                  y la <a href="#" class="text-warning">Pol√≠tica de Privacidad</a>
                </label>
                @if (terminos.invalid && terminos.touched) {
                  <div class="text-danger small mt-1">
                    Debes aceptar los t√©rminos y condiciones
                  </div>
                }
              </div>

              <!-- Bot√≥n de Registro -->
              <button 
                type="submit" 
                class="btn btn-warning w-100 py-3 fw-bold mb-3"
                [disabled]="registerForm.invalid || loading || passwordMismatch"
              >
                @if (!loading) {
                  <span>üöÄ Crear Cuenta</span>
                }
                @if (loading) {
                  <span>
                    <span class="spinner-border spinner-border-sm me-2"></span>
                    Creando cuenta...
                  </span>
                }
              </button>

              <!-- Enlace a login -->
              <div class="text-center">
                <span class="opacity-90">¬øYa tienes cuenta? </span>
                <a routerLink="/login" class="text-warning text-decoration-none fw-bold">
                  Inicia Sesi√≥n
                </a>
              </div>
            </form>
          }
        </div>
      </div>
    </div>
  </div>
</section>